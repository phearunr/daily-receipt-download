import{r as _,q as S,m as B,x as A,B as I,d as p,a as e,t as i,C as M,b as g,w as h,F as C,z as w,o as m,h as R,g as K,n as j,f as T,e as V}from"./app-db99a8de.js";import{l as q}from"./lodash-4ae8787a.js";import{t as z}from"./toast-fa86451f.js";import{_ as E}from"./_plugin-vue_export-helper-c27b6911.js";import{q as N,K as P,S as L,h as Q}from"./transition-3d77d2f5.js";const U={components:{Dialog:N,DialogOverlay:P,TransitionRoot:L,TransitionChild:Q},setup(D,s){const t=(()=>{var l;const o=((l=navigator==null?void 0:navigator.userAgentData)==null?void 0:l.platform)||(navigator==null?void 0:navigator.platform)||"unknown";return/(Mac|iPhone|iPod|iPad)/i.test(o)})()?"âŒ˜K":"Ctrl+K",v=_(!1),b=o=>{v.value||(o.metaKey||o.ctrlKey)&&o.key==="k"&&(v.value=!0)},d=_([]),u=_([]),a=_(0),x=q.debounce(async o=>{let{data:l}=await S.get(route("baskets.users.index"),{params:{term:o}});d.value=l,await B(),u.value=[]},250),n=o=>{var l;switch(o.code){case"ArrowDown":a.value===d.value.length-1?a.value=0:a.value+=1;break;case"ArrowUp":a.value===0?a.value=d.value.length-1:a.value-=1;break}(l=u.value[a.value])==null||l.scrollIntoView(!1)},k=o=>{["ArrowUp","ArrowDown"].includes(o.code)&&o.preventDefault()},r=()=>{d.value[a.value]&&(window.location=d.value[a.value].url)},f=(o,l)=>{S.put(route("baskets.users.confirm.barcode",o),{product_id:l}).then(y=>{y.data.errors?c(y.data.errors):(v.value=!1,c(y.data.success),s.emit("reloadBasket",10))}).catch(y=>{console.log(y)})},c=o=>{z.add({message:o??"msg"})};return A(()=>{window.addEventListener("keydown",b),x()}),I(()=>window.removeEventListener("keydown",b)),{onSubmit:r,navigateResults:n,onTermKeydown:k,resultsRefs:u,selectedIndex:a,results:d,search:x,isOpen:v,keyboardShortcut:t,verifyBarcodeIncreaseDropQuantity:f,addToast:c}}},F=e("svg",{class:"flex-none text-gray-400 -ml-1",width:"24",height:"24",fill:"none","aria-hidden":"true"},[e("path",{d:"m19 19-3.5-3.5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("circle",{cx:"11",cy:"11",r:"6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),G=e("span",{class:"text-sm text-gray-400 flex-1 text-left"},"Search...",-1),H={class:"flex-none text-xs font-semibold text-gray-400"},J={class:"flex flex-col overflow-hidden z-0 w-full max-w-2xl bg-white rounded-lg mx-4 max-h-[80vh] mt-[10vh] relative"},W=e("div",{class:"absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none"},[e("svg",{class:"w-5 h-5 text-gray-700",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1),X={class:"absolute inset-y-0 right-0 flex items-center pr-3"},Y={class:"overflow-auto"},Z={class:"divide-y divide-gray-100"},$=["onMousemove"],ee={class:"flex"},te=["src","alt"],oe=["onClick"],se=e("span",{class:"absolute inset-0"},null,-1),ne=[se],re={class:"ml-3"},ae={class:"font-semibold text-xs text-purple-600"},le={class:"text-xs font-semibold text-gray-600 mt-1"},ie={class:"text-xs font-semibold text-gray-600 mt-1"},de={class:"text-sm text-gray-400"},ce={class:"text-gray-600 font-semibold"},ue={class:"text-gray-600 font-semibold"},fe={key:0,class:"p-10 text-lg text-center text-gray-400"};function pe(D,s,O,t,v,b){const d=w("DialogOverlay"),u=w("TransitionChild"),a=w("Dialog"),x=w("TransitionRoot");return m(),p(C,null,[e("button",M({onClick:s[0]||(s[0]=n=>t.isOpen=!0)},D.$attrs,{class:"flex items-center space-x-2 border border-gray-900/10 shadow-sm px-3 py-1.5 hover:border-gray-300 focus:outline-none focus:border-gray-300 rounded-lg"}),[F,G,e("span",H,i(t.keyboardShortcut),1)],16),g(x,{show:t.isOpen,as:"template"},{default:h(()=>[g(a,{onKeydown:t.navigateResults,class:"fixed inset-0 z-50 flex justify-center items-start",open:t.isOpen,onClose:s[5]||(s[5]=n=>t.isOpen=!1)},{default:h(()=>[g(u,{enter:"duration-200 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0",as:"template"},{default:h(()=>[g(d,{class:"fixed inset-0 bg-black bg-opacity-70"})]),_:1}),g(u,{enter:"duration-200 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95",as:"template"},{default:h(()=>[e("div",J,[e("form",{onSubmit:s[4]||(s[4]=R((...n)=>t.onSubmit&&t.onSubmit(...n),["prevent"])),class:"relative flex items-center",action:"#"},[W,e("input",{onKeydown:s[1]||(s[1]=(...n)=>t.onTermKeydown&&t.onTermKeydown(...n)),onInput:s[2]||(s[2]=n=>t.search(n.target.value)),class:"w-full py-4 pl-12 border-b border-gray-100 outline-none placeholder-gray-400",type:"text",placeholder:"Search..."},null,32),e("div",X,[e("button",{onClick:s[3]||(s[3]=n=>t.isOpen=!1),class:"flex items-center p-1.5 uppercase font-semibold tracking-wider text-gray-700 rounded-md border border-gray-200 focus:outline-none focus:border-gray-300 text-xxs",type:"button"}," Esc ")])],32),e("div",Y,[e("ul",Z,[(m(!0),p(C,null,K(t.results,(n,k)=>(m(),p("div",{key:k},[(m(!0),p(C,null,K(n.order_items,(r,f)=>(m(),p("li",{key:f,ref_for:!0,ref:c=>{t.resultsRefs[f]=c},class:j([t.selectedIndex===f?"bg-gray-100":"","flex items-center justify-between px-4 py-2.5 relative"]),onMousemove:c=>t.selectedIndex=f},[e("div",ee,[e("img",{src:r.goods_image,alt:r.goods_name,class:"w-16 h-16 rounded-full object-cover border-white border-2 shrink-0 bg-gray-200"},null,8,te),e("button",{onClick:c=>t.verifyBarcodeIncreaseDropQuantity(n.id,r.goods_id)},ne,8,oe),e("div",re,[e("div",ae,i(r.product_name),1),e("div",le,i(r.bar_code),1),e("div",ie,i(r.order_quantity)+" x "+i(r.currency)+i(r.product_price),1)])]),e("div",de,[e("div",null,[T(" Dop Quantity: "),e("span",ce,i(r.drop_quantity),1)]),e("div",null,[T(" Total Price: "),e("span",ue,i(r.currency)+i(r.total_price),1)])])],42,$))),128))]))),128))]),t.results.length===0?(m(),p("p",fe," No results... ")):V("",!0)])])]),_:1})]),_:1},8,["onKeydown","open"])]),_:1},8,["show"])],64)}const _e=E(U,[["render",pe]]);export{_e as default};
